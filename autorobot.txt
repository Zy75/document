修正しました。2017/7/20

ーーーーーーーーーーーー自律走行ロボット企画書ーーーーーーーーーーーーーーーー

１．目的

遠隔地の状態をチェックして、さらには操作するロボットを開発したい。
例えば、出先から家の中にアクセスする。

また労働を肩代わりして、自律的に作業をこなすロボットを開発したい。
物を運ぶというテーマは比較的簡単で良いと思っている。
人を案内したり、何かを探索する、などのテーマもある。

これらのロボットに必要になるのが、ナビゲーションだ。
ナビゲーションは、周囲の環境を把握したうえで、自分の位置を知り、行きたい所に行くのに大事だ。

今開発の視野に入れているのが、特定の物を運ぶ作業を自動でくりかえすロボットだ。
また出先から家の中の特定の物をチェックして、外に通知するロボットも考えている。

２．課題

そこで、まず第一歩として、屋内の指定した経路をロボットがたどるという課題を設定する。

３．（屋内）測位

この課題にまず必要になるのが自己位置を知ることである。

屋内測位にはいくつかの方法がある。

GPSは、屋内で使うには誤差が大きい。

Wifi測位は、複数のWi-Fi基地局からの電波強度の違いから演算して自己位置を算出する方式だ。
基地局の位置のデータベースが既に構築されている。

beacon測位は、Bluetoothと同じ形式のビーコン発信器を屋内に設置して、
スマホ側がBLEと呼ばれる通信方式の信号強度判別を元に自己位置を推定する。

歩行者自立航法(PDR)は、現在の大半のスマホが備えている加速度、磁気、角速度などのセンサー機能を活用し、
自分の移動方向と移動量を推定します。

ライントレースロボットといって床に白線を引いてたどらせるロボットがあって、技術的に簡単だが、
今回の課題には良くても応用がきかないので除外する。

この他に今、採用を考えている方法にSLAM（自己位置推定と地図作成を同時実行）がある。
インフラを必要としない。
LIDARというレーザースキャンセンサで周囲の障害物との距離を測定できて、形状の重ねあわせで自分の位置を求める。

４．SLAM＋オドメトリ

GPSもWifi測位もbeacon測位も誤差が大きい。

今、rplidar A2というレーザースキャンセンサ（ライダー）を手にいれたので、SLAMを使ってみる。
センサが水平面内で回転していて、いろんな角度の障害物との距離を測定するので、止まっていても部屋の形状がわかる。

以前動かした、単眼（普通の）カメラによるSLAMでは、条件の良い動きをすることで初めて奥行きが得られた。

lidarはこの点優れているので、以前よりも良い結果を期待している。

５．オドメトリ

歩行者自立航法(PDR)と似たオドメトリも使う。

ロボットの車輪につけたセンサで回転量を測ると、ロボットの移動量がわかるので、自分の位置の情報の足しになる。

６．既存の開発例

youtubeの動画を探すと開発例がある。

lidarの代わりにkinectセンサを使うこともできる。

2010年ごろのブログ記事では、ハードウェアに掃除ロボットのルンバを使っている例がある。
自律制御に成功しているようだ。
http://ros-robot.blogspot.jp/2010/05/gmapping-roomba.html

４．企画
ハードウェアは、Raspberry Pi 3を搭載した 四輪車 でオドメトリが取れるもの。

今回手に入れたrplidar A2を載せる。

コースは、地図を作成したあとに、複数のつながった線分で指定する。

スラムのソフトウェアには ros 標準の gmapping かhector slamを使う。

５．システム構成

<自律走行車に乗せるもの>
rplidar A2
lidarのドライバーソフトウェア
Rosソフトウェア
Raspberry pi 3
オドメトリが取れる車輪
バッテリー

<ノート pc>
スラムのソフトウェア
Ros ソフト
自律走行の統合のための rosプログラム

６．作業工程
まずはハードウェアを作る。
車輪、モーター、車体、lidar、raspberry pi 3を組み立てる

次に raspberry pi 3に os をインストールし lidarのドライバーや ros などシステムを構築する。

ノートPCと車体のRaspberryPi3はwifiで通信する。

ノート pc 側では rosをセットアップし、スラムのソフトウェア をインストールし 
自律走行させるための ros のプログラムを書く

自律走行させるためのコードだが 走らせたいコースからずれていたら 修正するという簡単なコードのはずなので 作業は 大変ではないはず
そのソフトに センサー、モーター、スラムのソフト、を統合する機能も持たせるがpublishとsubscribeするだけなのでシンプルに書ける。
